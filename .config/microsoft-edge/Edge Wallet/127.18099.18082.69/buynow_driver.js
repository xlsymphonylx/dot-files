!function(){"use strict";var e={};let t;e.d=function(t,o){for(var i in o)e.o(o,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:o[i]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};let o,i;!function(e){e.IsBuyNowReady="IsBuyNowReady",e.BuyNowSubscribeNow="BuyNowSubscribeNow",e.BuyNowQuickAuthFinished="BuyNowQuickAuthFinished",e.BuyNowQuickAuthFailed="BuyNowQuickAuthFailed",e.LoadLocalCards="LoadLocalCards",e.BuyNowIsReady="BuyNowIsReady",e.BuyNowStartQuickAuth="BuyNowStartQuickAuth",e.BuyNowCheckoutFinished="BuyNowCheckoutFinished",e.LoadLocalCardsFinished="LoadLocalCardsFinished"}(o||(o={})),function(e){e.EntryPointReady="EntryPointReady",e.StartBuyNow="StartBuyNow",e.VisitPublisher="VisitPublisher",e.MerchantAuthSucceeded="MerchantAuthSucceeded",e.MerchantAuthFailed="MerchantAuthFailed",e.LoadLocalCards="LoadLocalCards"}(i||(i={}));const a="BuyNowRuntime";window[a]=new class{notifyHostPage(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}listenOnHostPageEvent(e,t){window.addEventListener(e,(e=>{t(e)}))}handleQuickAuthFinished(e){if(e.detail){const t=JSON.parse(e.detail);"skipped"===t.type?window[a].postMessageToHost(i.MerchantAuthFailed,[]):"display"!==t.type||t.displayed?"dismissed"===t.type&&"credential_returned"===t.reason&&window[a].postMessageToHost(i.MerchantAuthSucceeded,[]):window[a].postMessageToHost(i.MerchantAuthFailed,[])}}handleQuickAuthFailed(e){window[a].postMessageToHost(i.MerchantAuthFailed,[])}handleIsBuyNowReady(){window[a].notifyHostPage(o.BuyNowIsReady,"Ready"),window[a].postMessageToHost(i.EntryPointReady,[])}handleBuyNowSubscribeNow(e){window[a].postMessageToHost(i.StartBuyNow,[e.detail]),t=JSON.parse(e.detail)}handleLoadLocalCards(){window[a].postMessageToHost(i.LoadLocalCards,[])}raiseMessageFromHost(e){const i=e.shift(),s=JSON.parse(e[0]).event;if(i&&"StartMerchantAuth"===i)this.listenOnHostPageEvent(o.BuyNowQuickAuthFinished,this.handleQuickAuthFinished),this.listenOnHostPageEvent(o.BuyNowQuickAuthFailed,this.handleQuickAuthFailed),this.notifyHostPage(o.BuyNowStartQuickAuth,s);else if(i&&"VisitPublisher"===i){if(t&&t.plans){if(t.originalSubLink)return void window.open(t.originalSubLink,"_blank").focus();let e=0;for(let o=0;o<t.length;o+=1)if(t.plans[o].isPromotion){e=o;break}if(t.plans[e].url){const o=new URL(t.plans[e].url);window.open(o.origin,"_blank").focus()}}}else i&&"CheckoutFinished"===i?window[a].notifyHostPage(o.BuyNowCheckoutFinished,s):i&&"LocalCardsFinished"==i&&window[a].notifyHostPage(o.LoadLocalCardsFinished,s)}postMessageToHost(e,t){try{walletBuyNowNativeHandler&&walletBuyNowNativeHandler.sendMessageToHost(e,t)}catch(e){}}initialize(e){return window.BuyNowInitialized||(this.listenOnHostPageEvent(o.IsBuyNowReady,this.handleIsBuyNowReady),this.listenOnHostPageEvent(o.BuyNowSubscribeNow,this.handleBuyNowSubscribeNow),this.listenOnHostPageEvent(o.LoadLocalCards,this.handleLoadLocalCards),window.BuyNowInitialized=!0),!0}}}();